with temp_tab as (
select 
Household_Key                                                          , 
max(ZIP5)                                 as zip5                      , 
max(FSV_CMSI_Flag)                        as FSV_CMSI_Flag             , 
max(FSV_Credit_Card_Flag)                 as FSV_Credit_Card_Flag      ,
max(FSV_Deposit_Program_Flag)             as FSV_Deposit_Program_Flag  , 
max(FSV_Home_Equity_Flag)                 as FSV_Home_Equity_Flag      , 
max(FSV_ID_Theft_Flag)                    as FSV_ID_Theft_Flag         ,
max(FSV_Mortgage_Flag)                    as FSV_Mortgage_Flag         , 
max(INS_Client_Flag)                      as INS_Client_Flag           , 
max(TRV_Globalware_Flag)                  as TRV_Globalware_Flag       ,
max(coalesce(Length_Of_Residence,0))      as Length_Of_Residence       , 
max(coalesce(Income,'0'))                 as Income                    , 
max(coalesce(Children,'No'))              as Children                  ,  
max(coalesce(ERS_ENT_Count_Year_1,0))     as ERS_ENT_Count_Year_1      ,
max(coalesce(ERS_ENT_Count_Year_2,0))     as ERS_ENT_Count_Year_2      ,
max(coalesce(ERS_ENT_Count_Year_3,0))     as ERS_ENT_Count_Year_3      ,
max(coalesce(ERS_Member_Cost_Year_1,0))   as ERS_Member_Cost_Year_1    ,
max(coalesce(ERS_Member_Cost_Year_2,0))   as ERS_Member_Cost_Year_2    ,
max(coalesce(ERS_Member_Cost_Year_3,0))   as ERS_Member_Cost_Year_3    ,
max(coalesce(Mosaic_Household,'Unknown')) as Mosaic_Household          ,
max(coalesce(Mosaic_Global_Household,'Unknown')) as Mosaic_Global_Household ,
max(coalesce(kcl_B_IND_MosaicsGrouping,'Unknown')) as kcl_B_IND_MosaicsGrouping , 
max(coalesce(New_Mover_Flag,'N'))         as New_Mover_Flag            , 
coalesce(Breakdown_City,'Unknwon')        as Breakdown_City            ,
sum(coalesce(Basic_Cost,0))               as Basic_Cost                , 
max(coalesce(Clearing_Code_Last_Description,'Normal Service')) as Clearing_Code_Last_Description ,  
max(coalesce(Motorcycle_Indicator,'N'))   as Motorcycle_Indicator      ,
Plus_Cost, 
Premier_Cost, 
Prob1_Code_Description,
SC_Vehicle_Manufacturer_Name, 
SC_Vehicle_Model_Name,
Total_Cost
from member_raw mr
)
select count(*) as cnt from temp_tab;
